# Meeting Brief Generator

A CLI tool that produces Markdown meeting briefs for the next 24 hours by analyzing your Google Calendar events and enriching them with LinkedIn profiles and email conversation summaries.

## Features

- **Local-only execution** – no data stored off your machine
- **Google Calendar + Gmail integration** for meeting and email data
- **LinkedIn profile enrichment** using Playwright browser automation
- **OpenAI-powered summaries** for email conversations and professional backgrounds
- **External participant detection** based on your corporate domain
- **Web search fallback** when LinkedIn data is unavailable

## Prerequisites

- Python 3.8 or higher
- Google Cloud Project with Calendar and Gmail APIs enabled
- OpenAI API key (optional, for enhanced summaries)
- LinkedIn account (for profile enrichment)

## Installation

### 1. Clone the Repository

```bash
git clone <repository-url>
cd meeting-briefs
```

### 2. Set Up Virtual Environment

```bash
# Create virtual environment
python3 -m venv venv

# Activate virtual environment
# On macOS/Linux:
source venv/bin/activate
# On Windows:
venv\Scripts\activate
```

### 3. Install Dependencies

```bash
pip install -r requirements.txt
```

### 4. Install Playwright Browsers

```bash
playwright install chromium
```

## Setup

### 1. Google Cloud Project Setup

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select an existing one
3. Enable the following APIs:
   - Google Calendar API
   - Gmail API
4. Create OAuth 2.0 credentials:
   - Go to "APIs & Services" > "Credentials"
   - Click "Create Credentials" > "OAuth 2.0 Client IDs"
   - Choose "Desktop application"
   - Download the JSON file and save it as `client_secret.json` in the project root

### 2. Environment Variables

Create a `.env` file in the project root or add these to your shell profile (`~/.zshrc`, `~/.bashrc`):

```bash
# Required: Your corporate domain for external attendee detection
export CORP_DOMAIN="yourcompany.com"

# Optional: OpenAI API key for enhanced summaries
export OPENAI_API_KEY="sk-your-openai-api-key-here"
```

### 3. First-Time Google Authentication

Run the authentication flow once to create your token:

```bash
python src/meeting_brief.py --google-login
```

This will:
- Open a browser window for Google OAuth
- Request permissions for Calendar and Gmail (read-only)
- Save the authentication token locally

## Usage

### Basic Usage

Generate a meeting brief for the next 24 hours:

```bash
python src/meeting_brief.py
```

### Command Line Options

```bash
# Generate brief for next 48 hours
python src/meeting_brief.py --hours 48

# Save output to file
python src/meeting_brief.py --output brief.md

# Skip LinkedIn enrichment (faster, fully local)
python src/meeting_brief.py --no-linkedin

# Skip email conversation summaries
python src/meeting_brief.py --no-email

# Disable OpenAI (use rule-based summaries)
python src/meeting_brief.py --no-openai

# Enable debug logging
python src/meeting_brief.py --debug

# Combine options
python src/meeting_brief.py --hours 48 --output brief.md --debug
```

### Output Format

The tool generates a Markdown file with:

- **Meeting details** (title, time, attendees)
- **External attendee profiles** with LinkedIn enrichment
- **Email conversation summaries** for context
- **Professional background summaries** generated by OpenAI
- **Direct links** to LinkedIn profiles and search results

## Debugging

### Enable Debug Mode

```bash
python src/meeting_brief.py --debug
```

This will show:
- Environment variable status
- Google API calls and responses
- LinkedIn lookup progress
- OpenAI prompts and responses
- Email processing details

### Common Issues

#### LinkedIn Login Issues

If LinkedIn requires login:
1. The browser will open automatically
2. Log in to LinkedIn manually
3. Press Enter in the terminal when done
4. The session will be saved for future use

#### Google API Errors

```bash
# Re-authenticate if token expires
python src/meeting_brief.py --google-login
```

#### Playwright Issues

```bash
# Reinstall Playwright browsers
playwright install chromium

# Clear LinkedIn context (if login issues persist)
rm ~/.linkedin_context.json
```

### Debug Output Examples

```
[bold blue]Meeting Brief Generator Starting...
[bold blue]Environment Check:
[green]✓ CORP_DOMAIN: yourcompany.com
[green]✓ OPENAI_API_KEY: sk-1234...abcd
[blue]Fetching calendar events for the next 24 hours...
[green]Found 5 total events
[blue]Processing 5 events for external attendees...
[magenta]Launching Playwright browser for LinkedIn lookup: john@external.com (John Doe)
[green]Found search results page
[magenta]Clicking first visible/enabled result: John Doe
[green]OpenAI profile summary: John is a Senior Software Engineer at TechCorp...
```

## File Structure

```
meeting-briefs/
├── src/
│   ├── meeting_brief.py          # Main CLI tool
│   ├── linkedin_playwright.py    # LinkedIn automation
│   ├── meeting_briefs_web_search.py  # Web search utilities
│   └── gpt_meeting_briefs_web_search.py
├── client_secret.json            # Google OAuth credentials
├── requirements.txt              # Python dependencies
├── README.md                     # This file
└── .env                          # Environment variables (create this)
```

## Configuration

### Environment Variables

| Variable | Required | Description |
|----------|----------|-------------|
| `CORP_DOMAIN` | Yes | Your corporate domain for external attendee detection |
| `OPENAI_API_KEY` | No | OpenAI API key for enhanced summaries |

### Cache and Storage

The tool stores data locally in:
- `~/.cache/meeting_brief/cache.db` - Email and enrichment cache
- `~/.linkedin_context.json` - LinkedIn browser session
- `~/.cache/meeting_brief/token.json` - Google OAuth token

## Troubleshooting

### LinkedIn Lookup Fails

1. **Check login status**: Run with `--debug` to see if login is required
2. **Clear session**: Delete `~/.linkedin_context.json` and re-authenticate
3. **Browser issues**: Ensure Playwright is installed: `playwright install chromium`

### Email Summarization Issues

1. **Check Gmail permissions**: Re-run `--google-login` if needed
2. **OpenAI errors**: Verify your API key is set correctly
3. **Context length**: The tool automatically truncates long email threads

### Performance Issues

1. **Skip LinkedIn**: Use `--no-linkedin` for faster execution
2. **Skip emails**: Use `--no-email` to focus only on calendar data
3. **Reduce hours**: Use `--hours 12` for shorter lookahead

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests if applicable
5. Submit a pull request

## License

[Add your license information here]

## Support

For issues and questions:
1. Check the troubleshooting section above
2. Run with `--debug` and include the output
3. Open an issue with detailed error information 